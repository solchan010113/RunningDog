<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="walkLog">
   
   <!-- 쿼리문 작성 --> 
   
   <!-- 산책로 가져오기 -->
   <select id="trailSelect"  resultType="com.runningdog.vo.UseTrailVo">
      <![CDATA[
         SELECT co.coordno as coordNo
		        ,tr.trailno as trailNo
		        ,tr.name as name
		        ,co.coordorder as coordOrder
		        ,co.lat as lat
		        ,co.lng as lng
         FROM trail tr, coords co
         where co.type = 'trail'
         and tr.trailno = co.useno
         ORDER BY co.coordno asc
         , co.coordorder asc
      ]]>
   </select>   
  
   <!-- 내 강아지 가져오기 -->
   
   <select id="dogSelect"  parameterType="int" resultType="com.runningdog.vo.MoDogVo">
      <![CDATA[
         SELECT  us.userno as userNo 
		         ,us.name as userName
		         ,do.dogno as dogNo
		         ,do.name as dogName
	     FROM users us,dog do
	     where us.userno = #{userno}
	     and us.userno = do.userno
      ]]>
   </select>
   
   
   <!-- 산책기록 저장하기 -->
   <insert id="walkLogInsert"  parameterType="com.runningdog.vo.MoWalkLogVo" >
		<selectKey resultType="int" keyProperty="walkLogNo" order="BEFORE">
			<![CDATA[
				SELECT seq_walkdog_no.nextVal FROM dual    
			]]>
		</selectKey>
      <![CDATA[
         INSERT INTO walkLog
		 VALUES (#{walkLogNo},  
		         #{userNo},
		         1174010900, 
		         11111, 
		         #{title},
		         SYSDATE,
		         #{startTime},
		         #{endTime},
		         #{logTime},
		         #{distance},
		         #{content, jdbcType=VARCHAR},
		         '공개',
		         'T'
		         )
      ]]>
   </insert>
   
   <!-- 산책강아지 저장하기 -->
   <insert id="walkedDogInsert"  parameterType="com.runningdog.vo.WalkedDogVo" >
      <![CDATA[
         INSERT INTO walkedDog
		 VALUES (seq_walkeddog_no.NEXTVAL,
		         #{selectKey},
		         #{dogNo}   
		         )
      ]]>
   </insert>
   
    <!-- 좌표 저장하기 -->
   <insert id="coordsInsert"  parameterType="com.runningdog.vo.CoordsVo" >
      <![CDATA[
         INSERT INTO coords (coordNo, coordOrder, type, useNo, lng, lat) 
		 VALUES (seq_coords_no.NEXTVAL,
		         #{coordOrder},
		         'walkLog',
		         #{selectKey},
		         #{lng},
		         #{lat}
		         );
      ]]>
   </insert>
   

</mapper>